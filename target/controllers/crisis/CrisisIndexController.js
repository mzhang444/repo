define(["ember","controllers/UserActionMixin","utils/utils"],function(e,t,n){var r=e.ObjectController.extend(t,{isLoading:!1,isUpdate:!1,showSeverityView:null,init:function(){this.set("showSeverityView",!1)},needs:["crisis","application"],editCrisis:function(){this.set("controllers.crisis.isEdit",!0),this.transitionToRoute("crisis.edit")},toggleSeverityView:function(){var e,t=this,r=this.get("showSeverityView");r?(t.get("controllers.crisis.castedSeverityVote")&&this.get("controllers.application.user.isLoggedIn")&&(e={type:"statisticsCastSeverity",crisisID:this.get("controllers.crisis.id"),severity:this.get("controllers.crisis.castedSeverityVote")},n.ajax.makeAJAXPostCall("router.php",e,function(e){if(!e.error){var n=t.get("controllers.crisis.sumSeverity"),r=t.get("controllers.crisis.numSeverity"),i=t.get("controllers.crisis.castedSeverityVote");n+=i,i&&(r+=1),t.set("controllers.crisis.sumSeverity",n),t.set("controllers.crisis.numSeverity",r)}else console.log("some error occured in toggleSeverityView")})),t.set("showSeverityView",!t.get("showSeverityView"))):this.get("controllers.application.user.isLoggedIn")&&(t.set("showSeverityView",!t.get("showSeverityView")),e={type:"statisticsRevokeSeverity",crisisID:this.get("controllers.crisis.id")},t.get("controllers.crisis.castedSeverity")&&n.ajax.makeAJAXPostCall("router.php",e,function(e){if(!e.error){var n=t.get("controllers.crisis.sumSeverity"),r=t.get("controllers.crisis.numSeverity");n-=e.vote,r-=1,t.set("controllers.crisis.sumSeverity",n),t.set("controllers.crisis.numSeverity",r),t.set("controllers.crisis.castedSeverity",0)}else console.log("some error occured in toggleSeverityView")}),t.set("controllers.crisis.castedSeverityVote",0))}});return r});