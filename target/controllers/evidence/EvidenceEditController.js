define(["ember","models/Errors","utils/utils"],function(e,t,n){var r=e.ObjectController.extend({needs:["claim","application"],error:"",init:function(){this.set("error",t.create()),this._super.apply(this,arguments)},updateEvidence:function(){var e=this,t=this.get("support")?1:0,r={type:"evidenceCreate",crisisID:this.get("parentCrisisID"),claimID:this.get("parentClaimID"),title:this.get("title"),descr:this.get("descr"),support:t,lat:this.get("lat"),lng:this.get("lng"),street:this.get("street"),cityID:this.get("cityID"),countryID:this.get("countryID")},i=n.validatePayload(r),s=n.ERRORS.get("VALIDATION_ERR_CODE"),o=function(t){var r=n.ERRORS.get("EVIDENCE_ERR_CODE"),i=n.ERRORS.get("EVIDENCE_ERR_MSG");t.error?e.error.addError(r,i):(e.error.resolveError(r),e.transitionToRoute("evidence",e.get("model")))};i.valid?(this.error.resolveError(s),n.ajax.makeAJAXPostCall("router.php",r,o)):this.error.addError(s,i.message)},userCanCreate:function(){return this.get("controllers.application.user.isLoggedIn")}.property("controllers.application.user.isLoggedIn"),parentClaimName:function(){return this.get("controllers.claim.title")}.property("controllers.claim.title"),parentClaimLat:function(){return this.get("controllers.claim.lat")}.property("controllers.claim.title"),parentClaimLng:function(){return this.get("controllers.claim.lng")}.property("controllers.claim.title"),parentCrisisID:function(){return this.get("controllers.claim.crisisID")}.property("controllers.claim.crisisID"),parentClaimID:function(){return this.get("controllers.claim.claimID")}.property("controllers.claim.claimID"),close:function(){this.transitionToRoute("claim")}});return r});