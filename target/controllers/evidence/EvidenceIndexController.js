define(["ember","models/Comment","utils/utils","utils/store","controllers/UserActionMixin"],function(e,t,n,r,i){var s=e.ObjectController.extend(i,{needs:["application","evidence","claim","crisis"],tags:function(){var t,n=this.get("controllers.evidence.tags"),i=e.ArrayProxy.create({content:[]});return t=function(e){e&&i.pushObjects(e)},n&&r.getTags(n,t),i}.property("controllers.evidence.tags"),parentCrisisName:function(){return this.get("controllers.crisis.title")}.property("controllers.crisis.title"),parentClaimName:function(){return this.get("controllers.claim.title")}.property("controllers.claim.title"),userCanCreate:function(){return this.get("controllers.application.user.isLoggedIn")}.property("controllers.application.user.isLoggedIn"),editEvidence:function(){this.transitionToRoute("evidence.edit")},backToCrisis:function(){var e=this.get("controllers.crisis.content");this.transitionToRoute("crisis",e)},backToClaim:function(){var e=this.get("controllers.claim.content");this.transitionToRoute("claim",e)},addComment:function(){var e,r,i,s,o,u=t.create(),a=this.get("controllers.evidence.comments");u.set("author",this.get("controllers.application.user")),u.set("authorID",this.get("controllers.application.user.id")),u.set("evidenceID",this.get("controllers.evidence.id")),u.set("descr",this.get("controllers.evidence.tempComment")),u.set("flagged",0),e=this.get("controllers.evidence.error"),r={type:"commentAdd",descr:u.get("descr"),evidenceID:u.get("evidenceID")},i=function(t){var r=n.ERRORS.get("COMMENT_ERR_CODE"),i=n.ERRORS.get("COMMENT_ERR_MSG");t.error?e.addError(r,i):(e.resolveError(r),u.set("commentID",t.commentID))},s=n.validatePayload(r),o=n.ERRORS.get("VALIDATION_ERR_CODE"),s.valid?(e.resolveError(o),u.set("creationTime",Math.floor(new Date/1e3)),a=a.insertAt(0,u),this.set("controllers.evidence.tempComment",""),n.ajax.makeAJAXPostCall("router.php",r,i)):e.addError(o,s.message)}});return s});